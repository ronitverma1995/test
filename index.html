<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Manufacturing Capacity Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
        }

        header {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 10px 0;
        }

        .container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: auto;
            gap: 20px;
            padding: 20px;
        }

        .partition {
            background-color: #f5f5f5;
            padding: 20px;
        }

        .partition h2 {
            margin-top: 0;
        }

        .input-container {
            margin-bottom: 15px;
        }

        .input-container label {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .input-container input,
        .input-container select {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }

        .output-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .output-row div {
            flex: 1;
            margin-right: 15px;
        }

        .output-row div:last-child {
            margin-right: 0;
        }

        .output-row label {
            font-weight: 500;
        }

        .output-row p {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }

        #module-power-label {
            color: #4caf50;
            font-weight: 600;
            margin-right: 10px;
        }

        #module-power {
            font-weight: 600;
            color: #4caf50;
            font-size: 24px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Solar Manufacturing Capacity Calculator</h1>
        <p>Created by Ronit Kumar</p>
    </header>

    <div class="container">
        <div class="partition">
            <h2>General Parameters</h2>
            <div class="input-container">
                <label for="number-of-cells">Number of Cells:</label>
                <input type="number" id="number-of-cells" min="1" required>
            </div>
            <div class="input-container">
                <label for="cell-size">Cell Size:</label>
                <select id="cell-size" required>
                    <option value="156">M0 (156 x 156 mm)</option>
                    <option value="156.75">M2 (156.75 x 156.75 mm)</option>
                    <option value="158.75">M3 (158.75 x 158.75 mm)</option>
                    <option value="161.7">M4 (161.7 x 161.7 mm)</option>
                    <option value="165">M5 (165 x 165 mm)</option>
                    <option value="166">M6 (166 x 166 mm)</option>
                    <option value="182">M10/G10 (182 x 182 mm)</option>
                    <option value="210">M12/G12 (210 x 210 mm)</option>
                    <option value="230">G12+ (230 x 230 mm)</option>
                </select>
            </div>
            <div class="input-container">
                <label for="cell-type">Cell Type:</label>
                <select id="cell-type" required>
                    <option value="full">Full Cell</option>
                    <option value="half">Half-Cut Cell</option>
                </select>
            </div>
            <div class="input-container">
                <label for="cell-efficiency">Cell Efficiency (%):</label>
                <input type="number" id="cell-efficiency" min="0" max="100" step="0.01" required>
            </div>
            <div class="input-container">
                <label for="ctm-loss">CTM Loss (%):</label>
                <input type="number" id="ctm-loss" min="0" max="100" step="0.01" required>
            </div>
            <div class="input-container">
                <label for="module-power">Module Power:</label>
                <span id="module-power"></span> Watts
            </div>
        </div>

        <div class="partition">
            <h2>Stringers Cluster</h2>
            <div class="input-container">
                <label for="gross-throughput">Gross Throughput (Cells/Hr):</label>
                <input type="number" id="gross-throughput" min="1" required>
            </div>
            <div class="input-container">
                <label for="number-of-machines">Number of Machines:</label>
                <input type="number" id="number-of-machines" min="1" required>
            </div>
            <div class="input-container">
                <label for="availability">Availability (%):</label>
                <input type="number" id="availability" min="1" max="100" step="0.01" required>
            </div>
            <div class="output-row">
                <div>
                    <label for="modules-per-hour">Modules/Hr:</label>
                    <p id="modules-per-hour"></p>
                </div>
            </div>
            <div class="output-row">
                <div>
                    <label for="daily-module-production">Daily Module Production:</label>
                    <p id="daily-module-production"></p>
                </div>
            </div>
            <div class="output-row">
                <div>
                    <label for="daily-capacity">Daily Capacity (MW):</label>
                    <p id="daily-capacity"></p>
                </div>
            </div>
            <div class="output-row">
                <div>
                    <label for="annual-capacity">Annual Capacity (MW):</label>
                    <p id="annual-capacity"></p>
                </div>
            </div>
        </div>

        <div class="partition">
            <h2>Automation Cluster</h2>
            <!-- Input fields for Automation Cluster -->
        </div>

        <div class="partition">
            <h2>Lamination Cluster</h2>
            <!-- Input fields for Lamination Cluster -->
        </div>
    </div>

    <script>
        function calculateModulePower() {
            const numberOfCells = parseFloat(document.getElementById('number-of-cells').value);
            const cellSize = parseFloat(document.getElementById('cell-size').value);
            const cellType = document.getElementById('cell-type').value;
            const cellEfficiency = parseFloat(document.getElementById('cell-efficiency').value);
            const ctmLoss = parseFloat(document.getElementById('ctm-loss').value);

            const cellArea = (cellSize / 1000) ** 2; // Convert mm to m and calculate area
            let modulePower = numberOfCells * cellArea * 1000 * cellEfficiency * (cellType === 'full' ? 1 : 0.5) * (100 - ctmLoss) / 10000;
            document.getElementById('module-power').textContent = modulePower.toFixed(2);

            // Update Stringers Cluster calculations
            calculateStringerCluster();
        }

        function calculateStringerCluster() {
            const grossThroughput = parseFloat(document.getElementById('gross-throughput').value);
            const numberOfMachines = parseFloat(document.getElementById('number-of-machines').value);
            const availability = parseFloat(document.getElementById('availability').value);
            const numberOfCells = parseFloat(document.getElementById('number-of-cells').value);
            const modulePower = parseFloat(document.getElementById('module-power').textContent);

            const modulesPerHour = (grossThroughput / numberOfCells) * numberOfMachines * availability / 100;
            const dailyModuleProduction = modulesPerHour * 24;
            const dailyCapacity = dailyModuleProduction * modulePower / 1000000; // Convert MW to kW

            const annualCapacity = dailyCapacity * 365;

            document.getElementById('modules-per-hour').textContent = modulesPerHour.toFixed(2);
            document.getElementById('daily-module-production').textContent = dailyModuleProduction.toFixed(2);
            document.getElementById('daily-capacity').textContent = dailyCapacity.toFixed(2);
            document.getElementById('annual-capacity').textContent = annualCapacity.toFixed(2);
        }

        // Call calculateModulePower and calculateStringerCluster when the page loads
        window.onload = function() {
            calculateModulePower();
        };

        // Add event listeners to update results when input values change
        document.getElementById('number-of-cells').addEventListener('input', calculateModulePower);
        document.getElementById('cell-size').addEventListener('input', calculateModulePower);
        document.getElementById('cell-type').addEventListener('input', calculateModulePower);
        document.getElementById('cell-efficiency').addEventListener('input', calculateModulePower);
        document.getElementById('ctm-loss').addEventListener('input', calculateModulePower);

        document.getElementById('gross-throughput').addEventListener('input', calculateStringerCluster);
        document.getElementById('number-of-machines').addEventListener('input', calculateStringerCluster);
        document.getElementById('availability').addEventListener('input', calculateStringerCluster);
    </script>
</body>
</html